<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
		<script src="/socket.io/socket.io.js"></script>
		<title>Web Sockets</title>
	</head>
	<body>
		<main class="h-screen w-full flex flex-col gap-10 items-end p-10">
			<div
				id="messagesContainer"
				class="overflow-y-auto w-full h-full border border-black p-5">
				Messages
			</div>
			<form class="w-full" id="messageForm">
				<input
					tabindex="0"
					id="message"
					type="text"
					class="border border-black p-2"
					placeholder="Hit something...." />
				<button class="border p-2 cursor-pointer" id="sendBtn">Send ğŸš€</button>
			</form>
		</main>
		<script>
			const socket = io();
			const messageForm = document.querySelector("#messageForm");
			messageForm.addEventListener("submit", handleSubmit);
			const messageText = document.querySelector("#message");
			const messagesContainer = document.querySelector("#messagesContainer");

			function createMessage(text) {
				const messageDiv = document.createElement("div");
				messageDiv.innerText = text;
				messageDiv.className = "text-semibold text-lg text-blue-500";
				return messageDiv;
			}

			function handleSubmit(e) {
				e.preventDefault();
				const messageInput = messageText.value;

				if (messageInput) {
					// messagesContainer.appendChild(createMessage(messageInput));
					console.log({
						messageText: messageInput,
					});

					socket.emit("chat message", messageInput);

					messageText.value = "";
				}
			}

			socket.on("chat message", (msg) => {
				messagesContainer.appendChild(createMessage(msg));
			});
		</script>
	</body>
</html>
